---
description: 新機能を実装する際のワークフロー
---

# 新機能の実装

このプロジェクト（ayutenn-core）に新機能を実装する際は、以下のワークフローに従ってください。

## 1. ドキュメント確認

タスクを遂行する前に、必ず以下を確認してください：
- `/docs` ディレクトリのドキュメント
- プロジェクト全体の構造
- 既存の類似機能の実装

推測は避け、わからないことがあれば必ず質問して確度が高い実装をしてください。

## 2. 不明点の確認

ユーザーの依頼は不透明であったり、正確ではないことがあります。
実装計画に移る前に不明点やあいまいな点を確認してください。

## 3. 実装提案

実装計画を提案し、ユーザーの許可を得てください。

## 4. タスクの遂行

実装提案に従い、与えられたタスクを実行してください。

### コーディング規約

- **名前空間**: ルート名前空間は `ayutenn\core`
- **設計方針**: シンプルさを最優先とする
- **外部ライブラリ**: 最小限に抑え、フルスクラッチ実装を優先

## 5. テストコードの作成と実行（必須）

**テストは必須です。テストなしで実装を完了してはいけません。**

### テストの種類

1. **ユニットテスト** - 単体のクラス/メソッドのテスト
2. **インテグレーションテスト** - 依存するクラスがある場合は必ず作成

このプロジェクトでは**インテグレーションテスト**で実際のアプリの動きを再現して確認することを重要視します。

### テストメソッド名

`test_(日本語の説明)` 形式で記述：

```php
// ✅ 正しい例
public function test_JSONファイルから設定を読み込める(): void
public function test_存在しないキーを取得すると例外が発生する(): void

// ❌ 間違った例
public function testLoadFromJsonLoadsConfigSuccessfully(): void
```

### テストディレクトリ構造

```
tests/
└── unit/
    └── (機能名)/
        └── (クラス名)Test.php
```

### テスト実行

// turbo
```bash
composer test
```

## 6. セルフレビュー

以下の観点からセルフレビューを行ってください：
- 自分の今回の変更が、全体の処理の流れを複雑化させていないか
- よりシンプルな実装にできないか
- テストが不足していないか

問題がある場合、「3. 実装提案」からプロセスを再度実施してください。

## 7. ドキュメントの更新

作業した内容に応じて、`/docs` ディレクトリのドキュメントを更新してください。
